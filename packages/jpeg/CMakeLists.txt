set(JPEG_VERSION 9.3)
set(JPEG_PACKAGE_NAME jpeg-${JPEG_VERSION})
set(JPEG_PACKAGE_PATH ${CMAKE_CURRENT_LIST_DIR}/${JPEG_PACKAGE_NAME}.tar.bz2)

set(JPEG_PREFIX ${THIRDPARTY_INSTALL_PATH})

GENERATE_PATCH_COMMAND(JPEG_PACKAGE_PATCH_CMD ${JPEG_PACKAGE_NAME})

if(CMAKE_CROSSCOMPILING)
    set(JPEG_CONFIGURE_COMMAND ../${JPEG_PACKAGE_NAME}/configure --host=${AUTOTOOL_HOST} --prefix=${JPEG_PREFIX} --enable-static --enable-shared --disable-silent-rules)
else()
    set(JPEG_CONFIGURE_COMMAND ../${JPEG_PACKAGE_NAME}/configure --prefix=${JPEG_PREFIX} --enable-static --disable-cli --enable-shared --disable-silent-rules)
endif()

find_package(JPEG ${JPEG_VERSION} EXACT QUIET)
set(JPEG_TARGET ${JPEG_PACKAGE_NAME})
THIRDPARTY_CACHE_SEARCH(${JPEG_PACKAGE_NAME})

if(${${JPEG_PACKAGE_NAME}_CACHE_FOUND})
    THIRDPARTY_ADD_CACHE_TARGET(${JPEG_TARGET} ${JPEG_PACKAGE_NAME})
endif()

if(EXACT ${JPEG_PACKAGE_PATH})
    THIRDPARTY_ADD_CACHE_TARGET(${JPEG_TARGET} ${JPEG_PACKAGE_NAME})
endif()

message(STATUS "${${JPEG_PACKAGE_NAME}_CACHE_FOUND}")

add_custom_target(jpeg DEPENDS ${JPEG_TARGET})

set(JPEG_PREFIX ${JPEG_PREFIX} PARENT_SCOPE)
set(JPEG_TARGET ${JPEG_TARGET} PARENT_SCOPE)
