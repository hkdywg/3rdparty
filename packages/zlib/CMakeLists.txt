set(ZLIB_VERSION 1.2.11)
set(ZLIB_PACKAGE_NAME zlib-${ZLIB_VERSION})
set(ZLIB_PACKAGE_PATH ${CMAKE_CURRENT_LIST_DIR}/${ZLIB_PACKAGE_NAME}.tar.bz2)

set(ZLIB_PREFIX ${THIRDPARTY_INSTALL_PATH})

GENERATE_PATCH_COMMAND(ZLIB_PACKAGE_PATCH_CMD ${ZLIB_PACKAGE_NAME})

find_package(ZLIB ${ZLIB_VERSION} EXACT QUIET)

set(ZLIB_TARGET zlib)

ExternalProject_Add(
            ${ZLIB_PACKAGE_NAME}
            URL ${ZLIB_PACKAGE_PATH}
            PATCH_COMMAND "${ZLIB_PACKAGE_PATCH_CMD}"
            BUILD_COMMAND $(MAKE) ${VERBOSE_MAKEFILE} -j${PROCESSORS_NUMBER}
    )

add_custom_target(zlib DEPENDS ${ZLIB_TARGET})

set(ZLIB_TARGET ${ZLIB_TARGET} PARENT_SCOPE)
